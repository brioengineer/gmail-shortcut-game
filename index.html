<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gmail Shortcut Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .shortcut-key {
            display: inline-block;
            padding: 0.25rem 0.6rem;
            border: 1px solid #ccc;
            border-radius: 0.3rem;
            background-color: #f7f7f7;
            box-shadow: 0 2px 0 #ccc;
            font-weight: 500;
            color: #333;
            margin: 0 0.25rem;
        }
        .feedback-animation {
            animation: pop-in 0.3s ease-out;
        }
        @keyframes pop-in {
            0% { transform: scale(0.8); opacity: 0; }
            80% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div id="game-container" class="w-full max-w-4xl mx-auto">
        <div class="text-center mb-6">
            <h1 class="text-4xl font-bold text-gray-800">Gmail Shortcut Challenge</h1>
            <p class="text-gray-600 mt-2">Press the correct key to complete the action. How fast can you go?</p>
        </div>

        <!-- Game UI -->
        <div class="bg-white rounded-lg shadow-xl p-6 relative">
            <!-- Score and Instruction -->
            <div class="flex justify-between items-center mb-4 border-b pb-4">
                <div id="instruction-card" class="bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 rounded-md w-full">
                    <p class="font-bold">Your task:</p>
                    <p id="instruction-text" class="text-lg">Click "Start Game" to begin!</p>
                </div>
                 <div class="text-right ml-4 flex-shrink-0 space-y-2">
                    <div>
                        <div class="text-sm text-gray-500">SCORE</div>
                        <div id="score" class="text-3xl font-bold text-gray-800">0</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-500">TIME</div>
                        <div id="timer" class="text-3xl font-bold text-gray-800">60</div>
                    </div>
                     <div>
                        <div class="text-sm text-gray-500">BEST</div>
                        <div id="high-score" class="text-3xl font-bold text-gray-800">0</div>
                    </div>
                </div>
            </div>

            <!-- Mock Email -->
            <div id="email-view">
                <div class="flex items-center justify-between mb-3">
                    <h2 id="email-subject" class="text-2xl font-semibold text-gray-800">Welcome to the Challenge!</h2>
                    <div id="email-labels" class="flex space-x-2"></div>
                </div>
                <div class="flex items-center space-x-3 mb-6">
                    <div class="w-10 h-10 bg-green-500 text-white flex items-center justify-center rounded-full font-bold" id="email-avatar">G</div>
                    <div>
                        <div class="font-bold text-gray-700" id="email-sender">Game Master</div>
                        <div class="text-sm text-gray-500">to me</div>
                    </div>
                </div>
                <div id="email-body" class="text-gray-600 leading-relaxed">
                    <p>This is a simulated Gmail inbox. An instruction will appear at the top. Your job is to press the correct keyboard shortcut to perform that action.</p>
                    <p class="mt-4">For example, if it says "Compose a new email", you would press the 'c' key.</p>
                    <p class="mt-4">Good luck!</p>
                </div>
            </div>

            <!-- Feedback Overlay -->
            <div id="feedback-overlay" class="absolute inset-0 bg-white bg-opacity-80 flex-col items-center justify-center rounded-lg text-center p-8 hidden">
                <div id="feedback-icon" class="text-6xl mb-4"></div>
                <div id="feedback-text" class="text-3xl font-bold"></div>
                <div id="feedback-hint" class="text-lg text-gray-600 mt-2"></div>
            </div>
            
            <!-- Modal for specific actions -->
            <div id="action-modal" class="absolute inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center rounded-lg hidden">
                <div class="bg-white p-6 rounded-lg shadow-2xl text-center">
                    <h3 id="modal-title" class="text-xl font-bold"></h3>
                </div>
            </div>
        </div>
        
        <div class="text-center mt-6">
            <button id="start-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-transform transform hover:scale-105">Start Game</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const instructionText = document.getElementById('instruction-text');
            const scoreEl = document.getElementById('score');
            const timerEl = document.getElementById('timer');
            const highScoreEl = document.getElementById('high-score');
            const startButton = document.getElementById('start-button');
            const feedbackOverlay = document.getElementById('feedback-overlay');
            const feedbackIcon = document.getElementById('feedback-icon');
            const feedbackText = document.getElementById('feedback-text');
            const feedbackHint = document.getElementById('feedback-hint');
            const emailSubject = document.getElementById('email-subject');
            const emailSender = document.getElementById('email-sender');
            const emailAvatar = document.getElementById('email-avatar');
            const emailBody = document.getElementById('email-body');
            const emailLabels = document.getElementById('email-labels');
            const actionModal = document.getElementById('action-modal');
            const modalTitle = document.getElementById('modal-title');
            
            // --- Game State ---
            let score = 0;
            let highScore = 0;
            let activeChallenge = null;
            let gameActive = false;
            let challenges = [];
            let timerInterval = null;
            let timeLeft = 60;
            const TIME_LIMIT = 60;
            
            // --- Game Data ---
            const shortcuts = [
                { key: 'e', code: 'KeyE', shift: false, description: 'Archive this email' },
                { key: 'v', code: 'KeyV', shift: false, description: 'Move this email' },
                { key: 'shift + t', code: 'KeyT', shift: true, description: 'Create a task from this email' },
                { key: 'l', code: 'KeyL', shift: false, description: 'Label this email' },
                { key: 'r', code: 'KeyR', shift: false, description: 'Reply to this email' },
                { key: 'a', code: 'KeyA', shift: false, description: 'Reply to all' },
                { key: 'c', code: 'KeyC', shift: false, description: 'Compose a new email' }
            ];

            const mockEmails = [
                { subject: "Project Update", sender: "Alice", body: "Just wanted to share the latest updates on Project Phoenix. The new designs are attached." },
                { subject: "Team Lunch?", sender: "Bob", body: "Hey team, are we still on for lunch this Friday? Let me know your thoughts!" },
                { subject: "Weekly Report", sender: "Charlie", body: "Please find the weekly performance report attached. Let's discuss it in our meeting tomorrow." },
                { subject: "Your recent order", sender: "Online Store", body: "Thank you for your order! Your items have been shipped and will arrive in 3-5 business days." },
                { subject: "Networking Event Invite", sender: "Eva", body: "Hi there, I'd like to invite you to our annual tech networking event next month. Hope to see you there!" }
            ];

            // --- Initial Setup ---
            const loadHighScore = () => {
                highScore = localStorage.getItem('gmailShortcutHighScore') || 0;
                highScoreEl.textContent = highScore;
            };
            
            // --- Game Logic ---
            const startGame = () => {
                score = 0;
                gameActive = true;
                timeLeft = TIME_LIMIT;
                timerEl.textContent = timeLeft;
                clearInterval(timerInterval);

                // Shuffle and create a queue of challenges
                challenges = [...shortcuts, ...shortcuts, ...shortcuts].sort(() => Math.random() - 0.5); // Repeat list to fill time
                updateScore();
                startButton.textContent = 'Restart Game';
                
                timerInterval = setInterval(() => {
                    timeLeft--;
                    timerEl.textContent = timeLeft;
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);

                nextChallenge();
            };

            const nextChallenge = () => {
                if (challenges.length === 0) {
                    endGame();
                    return;
                }

                // Get the next challenge from the queue
                activeChallenge = challenges.pop();
                const email = mockEmails[Math.floor(Math.random() * mockEmails.length)];

                // Update UI
                instructionText.textContent = activeChallenge.description;
                emailSubject.textContent = email.subject;
                emailSender.textContent = email.sender;
                emailAvatar.textContent = email.sender.charAt(0).toUpperCase();
                emailBody.innerHTML = `<p>${email.body}</p>`;
                emailLabels.innerHTML = '';
            };
            
            const endGame = () => {
                clearInterval(timerInterval);
                gameActive = false;
                
                let endMessage = `Time's up! Final score: ${score}`;

                // Check for new high score
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('gmailShortcutHighScore', highScore);
                    highScoreEl.textContent = highScore;
                    endMessage += ' 🎉 New High Score!';
                }
                
                instructionText.textContent = endMessage;
                startButton.textContent = 'Play Again';
                emailSubject.textContent = 'Time is up!';
                emailAvatar.textContent = '⏰';
                emailBody.innerHTML = `<p>You managed to get ${score} correct answers. ${score > highScore ? 'You set a new high score!' : `Your best is ${highScore}.`} Try again!</p>`;
            }

            const handleCorrectAnswer = () => {
                score++;
                updateScore();
                showFeedback(true);
                
                // Show a quick modal for certain actions
                if (['v', 'l'].includes(activeChallenge.key)) {
                    const action = activeChallenge.key === 'v' ? 'Move to...' : 'Label as...';
                    modalTitle.textContent = action;
                    actionModal.classList.remove('hidden');
                    actionModal.classList.add('flex');
                } else if (activeChallenge.key === 'shift + t') {
                    modalTitle.textContent = 'Task Created!';
                    actionModal.classList.remove('hidden');
                    actionModal.classList.add('flex');
                }


                setTimeout(() => {
                    feedbackOverlay.classList.add('hidden');
                    actionModal.classList.add('hidden');
                    nextChallenge();
                }, 1200);
            };

            const handleWrongAnswer = (pressedKey) => {
                showFeedback(false, pressedKey);
                setTimeout(() => {
                    feedbackOverlay.classList.add('hidden');
                }, 1500);
            };

            const showFeedback = (isCorrect, pressedKey = '') => {
                feedbackOverlay.classList.remove('hidden');
                feedbackOverlay.classList.add('flex', 'feedback-animation');
                
                if (isCorrect) {
                    feedbackIcon.innerHTML = '✅';
                    feedbackIcon.style.color = '#10B981';
                    feedbackText.textContent = 'Correct!';
                    feedbackText.style.color = '#10B981';
                    feedbackHint.innerHTML = '';
                } else {
                    feedbackIcon.innerHTML = '❌';
                    feedbackIcon.style.color = '#EF4444';
                    feedbackText.textContent = 'Not quite!';
                    feedbackText.style.color = '#EF4444';
                    feedbackHint.innerHTML = `You pressed <span class="shortcut-key">${pressedKey}</span>. The correct shortcut is <span class="shortcut-key">${activeChallenge.key}</span>.`;
                }
            };
            
            const updateScore = () => {
                scoreEl.textContent = score;
            };

            // --- Event Listeners ---
            startButton.addEventListener('click', startGame);

            document.addEventListener('keydown', (e) => {
                if (!gameActive || e.repeat) return;
                
                // Prevent browser shortcuts from firing (e.g., Ctrl+R)
                if (e.key !== 'F5' && e.key !== 'F12') {
                    e.preventDefault();
                }

                if (e.code === activeChallenge.code && e.shiftKey === activeChallenge.shift) {
                    handleCorrectAnswer();
                } else {
                    let pressed = '';
                    if (e.shiftKey) pressed += 'shift + ';
                    if (e.ctrlKey) pressed += 'ctrl + ';
                    if (e.altKey) pressed += 'alt + ';
                    pressed += e.key.toLowerCase();
                    
                    // Don't penalize for pressing just 'shift', 'ctrl', etc.
                    if (!['shift', 'control', 'alt'].includes(e.key.toLowerCase())) {
                       handleWrongAnswer(pressed);
                    }
                }
            });

            // Load high score on initial page load
            loadHighScore();
        });
    </script>
</body>
</html>

